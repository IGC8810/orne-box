<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="orne_box">
  <xacro:property name="PI" value="3.1415926535897931"/>
  <xacro:include filename="$(find orne_box_description)/urdf/material_colors.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/orne_box.gazebo.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/links/base_link.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/links/caster_wheel_link.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/links/caster_swivel_link.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/links/wheel_link.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/joints/caster_wheel_joint.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/joints/caster_swivel_joint.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/joints/wheel_joint.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/sensors/imu.urdf.xacro"/>
  <xacro:include filename="$(find orne_box_description)/urdf/sensors/hokuyo.urdf.xacro"/>
  <!-- Setting for base -->
  <xacro:base_link/>
  <!-- Setting for caster -->
  <xacro:caster_wheel_link prefix="left"/>
  <xacro:caster_swivel_link prefix="left"/>
  <xacro:caster_wheel_joint prefix="left"/>
  <xacro:caster_swivel_joint prefix="left" parent="base_link">
    <origin xyz="0.362 0.150 0.115" rpy="0 0 0"/>
  </xacro:caster_swivel_joint>
  <xacro:caster_wheel_link prefix="right"/>
  <xacro:caster_swivel_link prefix="right"/>
  <xacro:caster_wheel_joint prefix="right"/>
  <xacro:caster_swivel_joint prefix="right" parent="base_link">
    <origin xyz="0.362 -0.150 0.115" rpy="0 0 0"/>
  </xacro:caster_swivel_joint>
  <!-- Setting for left wheel -->
  <xacro:wheel_joint prefix="left" parent="base_link">
    <origin xyz="0.0 0.23075 0.152" rpy="${-PI/2} 0 0"/>
    <axis xyz="0 0 1"/>
  </xacro:wheel_joint>
  <xacro:wheel_link prefix="left" width="0.045" radius="0.152">
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </xacro:wheel_link>
  <!-- Setting for right wheel -->
  <xacro:wheel_joint prefix="right" parent="base_link">
    <origin xyz="0.0 -0.23075 0.152" rpy="${-PI/2} 0 0"/>
    <axis xyz="0 0 1"/>
  </xacro:wheel_joint>
  <xacro:wheel_link prefix="right" width="0.045" radius="0.152">
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </xacro:wheel_link>
  <!-- Setting for IMU -->
  <xacro:sensor_imu name="imu" parent="base_link" size="0.05 0.05 0.05">
    <origin xyz="0.23 0.0 0.270" rpy="${-PI} 0 ${PI/2}"/>
  </xacro:sensor_imu>
  <!-- Setting for 2D-LiDAR -->
  <xacro:sensor_hokuyo name="hokuyo" parent="base_link" size="0.05 0.05 0.05">
    <origin xyz="0.374295 0 0.2185" rpy="${-PI} 0 0"/>
  </xacro:sensor_hokuyo>

  <joint name="lidar_with_mirror_prismatic_joint" type="prismatic">
    <parent link="base_link"/>
    <child link="lidar_with_mirror_prismatic_link"/>
    <origin xyz="1.0 0 0.3" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit effort="100" velocity="100.0" lower="-0.3" upper="1" />
  </joint>
  <link name="lidar_with_mirror_prismatic_link">
    <inertial>
      <origin xyz="0 0 0" />
      <mass value="0.2" />
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1" />
    </inertial>
  </link>

  <joint name="lidar_with_mirror_pitch_joint" type="revolute">
    <parent link="lidar_with_mirror_prismatic_link"/>
    <child link="lidar_with_mirror_pitch_link"/>
    <origin xyz="0 0 0" rpy="0 ${PI/9} 0"/>
    <axis xyz="0 1 0"/>
    <limit effort="100" velocity="100.0" lower="${-PI}" upper="${PI}" />
  </joint>
  <link name="lidar_with_mirror_pitch_link">
    <inertial>
      <origin xyz="0 0 0" />
      <mass value="0.2" />
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1" />
    </inertial>
  </link>

  <joint name="lidar_with_mirror_roll_joint" type="revolute">
    <parent link="lidar_with_mirror_pitch_link"/>
    <child link="lidar_with_mirror_roll_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <axis xyz="1 0 0"/>
    <limit effort="100" velocity="100.0" lower="${-PI}" upper="${PI}" />
  </joint>
  <link name="lidar_with_mirror_roll_link">
    <inertial>
      <origin xyz="0 0 0" />
      <mass value="0.2" />
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1" />
    </inertial>
  </link>

  <xacro:property name="len" value="0.1" />
  <xacro:property name="front" value="0" />
  <xacro:property name="height" value="0" />


  <xacro:sensor_hokuyo name="lidar_with_mirror_center" parent="lidar_with_mirror_roll_link" size="0.05 0.05 0.05">
    <origin xyz="${front} 0 ${height}" rpy="0 0 0"/>
  </xacro:sensor_hokuyo>

  <joint name="lidar_with_mirror_mirror1_roll_joint" type="revolute">
    <parent link="lidar_with_mirror_center_link"/>
    <child link="lidar_with_mirror_mirror1_roll_link"/>
    <origin xyz="0 ${len} 0" rpy="${-PI/4} 0 0"/>
    <axis xyz="-1 0 0"/>
    <limit effort="100" velocity="100.0" lower="${-PI}" upper="${PI}" />
  </joint>
  <link name="lidar_with_mirror_mirror1_roll_link">
    <inertial>
      <origin xyz="0 0 0" />
      <mass value="0.2" />
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1" />
    </inertial>
  </link>


  <xacro:sensor_hokuyo name="lidar_with_mirror_left" parent="lidar_with_mirror_mirror1_roll_link" size="0.05 0.05 0.05">
    <origin xyz="0 ${-len} 0" rpy="0 0 0"/>
  </xacro:sensor_hokuyo>

  <joint name="lidar_with_mirror_mirror2_roll_joint" type="revolute">
    <parent link="lidar_with_mirror_center_link"/>
    <child link="lidar_with_mirror_mirror2_roll_link"/>
    <origin xyz="0 ${-len} 0" rpy="${PI/4} 0 0"/>
    <axis xyz="1 0 0"/>
    <limit effort="100" velocity="100.0" lower="${-PI}" upper="${PI}" />
  </joint>
  <link name="lidar_with_mirror_mirror2_roll_link">
    <inertial>
      <origin xyz="0 0 0" />
      <mass value="0.2" />
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1" />
    </inertial>
  </link>

  <xacro:sensor_hokuyo name="lidar_with_mirror_right" parent="lidar_with_mirror_mirror2_roll_link" size="0.05 0.05 0.05">
    <origin xyz="0 ${len} 0" rpy="0 0 0"/>
  </xacro:sensor_hokuyo>

</robot>
